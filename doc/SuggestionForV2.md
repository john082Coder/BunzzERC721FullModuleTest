Implementing features for handling maxBatchSize and collectionSize